# 유동적 대화 vs 정해진 시나리오

## 현재 구현 상태

### 유동적 대화 (음성 모드)

**음성 모드를 사용하면 AI가 유동적으로 대화합니다:**

1. **사용자의 실제 음성 입력** → STT → 텍스트 변환
2. **대화 히스토리 포함** → 백엔드로 전송
3. **AI가 이전 대화를 기억** → 맥락에 맞는 응답 생성
4. **매번 다른 응답** → 자연스러운 대화 흐름

**예시:**
```
사용자: "안녕하세요, 금융감독원입니다."
AI: "아... 네? 금융감독원이요?"

사용자: "네, 계좌 안전조치가 필요합니다."
AI: "어... 계좌요? 제가 뭘 잘못한 건가요?"

사용자: "지금 당장 계좌번호를 알려주세요."
AI: "음... 그런데 금융감독원에서 직접 계좌번호를 물어보시는 게 맞나요?"
```

→ **매번 다른 응답, 이전 대화 내용을 기억**

### 정해진 시나리오 (시뮬레이션 모드)

**시뮬레이션 모드는 정해진 대화를 순차적으로 재생합니다:**

1. **고정된 대화 배열** → 순차적으로 재생
2. **매번 동일한 응답** → 자연스럽지 않음
3. **대화 히스토리 무시** → 맥락 없음

**예시:**
```
턴 1: "안녕하세요, 금융감독원입니다."
턴 2: "네, 계좌 안전조치가 필요합니다."
턴 3: "지금 당장 계좌번호를 알려주세요."
...
```

→ **매번 동일한 응답, 대화 맥락 없음**

---

## 비교표

| 항목 | 유동적 대화 (음성 모드) | 정해진 시나리오 |
|------|------------------------|-----------------|
| **대화 방식** | 정해진 시나리오 | 유동적 대화 |
| **AI 응답** | 매번 동일 | 매번 다름 |
| **대화 히스토리** | 무시 | 기억 |
| **맥락 이해** | 없음 | 있음 |
| **자연스러움** | 낮음 | 높음 |
| **스캠 분석** | 제한적 | 정확함 |
| **구현 난이도** | 쉬움 | 어려움 |

---

## 권장사항

### 음성 모드 사용 권장

음성 모드를 사용하면:
- 실제 피싱 전화를 더 정확하게 분석할 수 있습니다
- AI가 맥락을 이해하고 자연스럽게 대화합니다
- 매번 다른 응답으로 더 현실적인 시뮬레이션이 가능합니다

### 시뮬레이션 모드는 제거됨

시뮬레이션 모드는 더 이상 사용되지 않습니다. 모든 통화는 음성 모드로 진행됩니다.

---

## 기술적 구현

### 유동적 대화 구현 방법

1. **대화 히스토리 전송**
   ```javascript
   // frontend/services/voice-call-handler.js
   const response = await callService.processAudio(
     callId, 
     text, 
     userRole,
     conversationHistory  // 전체 대화 히스토리 전송
   );
   ```

2. **백엔드에서 맥락 기반 응답 생성**
   ```python
   # backend/services/ai_service.py
   def generate_response(self, user_input, scam_score, user_role, conversation_history):
       # 대화 히스토리를 포함하여 프롬프트 생성
       system_prompt = self._get_system_prompt(scam_score, user_role)
       # OpenAI API에 대화 히스토리와 함께 전송
   ```

3. **Temperature 증가**
   - Temperature를 0.8로 설정하여 더 다양한 응답 생성
   - Max tokens를 200으로 증가하여 더 긴 응답 가능

---

## 결론

유동적 대화 방식이 피싱 분석에 더 적합하며, 현재 프로젝트에서는 음성 모드만 사용합니다. 시뮬레이션 모드는 제거되었습니다.
