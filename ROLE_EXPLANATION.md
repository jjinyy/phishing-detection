# 역할 및 동작 방식 설명

## 현재 구현 방식

### 기본 구조

**현재는 AI가 항상 피싱 피해자 역할을 합니다.**

```
[사용자 마이크 입력] 
    ↓
[STT: 음성 → 텍스트]
    ↓
[백엔드로 전송]
    ↓
[AI 분석 및 응답 생성]
    ↓
[AI = 피싱 피해자 역할로 응답]
    ↓
[TTS: 텍스트 → 음성]
    ↓
[스피커로 재생]
```

### 예시 시나리오

**시나리오 1: 사용자가 피싱범처럼 말하는 경우**
- 사용자: "안녕하세요, 금융감독원입니다. 계좌번호를 알려주세요."
- AI (피해자 역할): "어... 금융감독원이요? 제가 확인해보고 다시 연락드리겠습니다."
- 스캠 점수: 증가 (피싱 패턴 감지)

**시나리오 2: 사용자가 피해자처럼 말하는 경우**
- 사용자: "네, 제가 뭘 잘못한 건가요?"
- AI (피해자 역할): "음... 그런데 금융감독원에서 직접 계좌번호를 물어보시는 게 맞나요?"
- 스캠 점수: 증가 (피싱 패턴 감지)

---

## 역할 선택 기능

### 사용자 역할 선택

사용자는 통화 시작 전에 자신의 역할을 선택할 수 있습니다:

1. **피싱범 역할**: 사용자가 피싱범처럼 말함
   - AI는 피해자 역할로 응답
   - 스캠 점수 계산됨

2. **피해자 역할**: 사용자가 피해자처럼 말함
   - AI는 피싱범 역할로 응답
   - 스캠 점수 계산 안 됨 (테스트 목적)

### 역할에 따른 AI 동작

**피싱범 역할 선택 시:**
- AI는 피해자처럼 당황하고 헷갈리는 톤으로 응답
- 피싱 패턴이 감지되면 스캠 점수 증가
- 예: "어... 금융감독원이요? 제가 확인해보고 다시 연락드리겠습니다."

**피해자 역할 선택 시:**
- AI는 피싱범처럼 말함
- 스캠 점수 계산 안 됨 (테스트 목적)
- 예: "지금 당장 계좌번호를 알려주세요. 시간이 없습니다."

---

## 기술적 구현

### 프론트엔드

```javascript
// frontend/app-full.js
const [userRole, setUserRole] = useState('scammer'); // 'scammer' 또는 'victim'

// 역할 선택 UI
<label>
  <input 
    type="radio" 
    value="scammer" 
    checked={userRole === 'scammer'}
    onChange={(e) => setUserRole(e.target.value)}
  />
  피싱범 역할
</label>
```

### 백엔드

```python
# backend/services/ai_service.py
def generate_response(self, user_input, scam_score, user_role):
    if user_role == 'scammer':
        # AI는 피해자 역할로 응답
        system_prompt = "당신은 피싱 전화를 받은 피해자입니다..."
    else:
        # AI는 피싱범 역할로 응답
        system_prompt = "당신은 피싱 전화를 거는 사기범입니다..."
```

---

## 사용 시나리오

### 시나리오 1: 실제 피싱 전화 테스트
1. 사용자가 "피싱범 역할" 선택
2. 사용자가 실제 피싱 전화를 받은 것처럼 말함
3. AI가 피해자 역할로 응답하며 스캠 점수 계산
4. 통화 종료 후 리포트 확인

### 시나리오 2: AI 동작 테스트
1. 사용자가 "피해자 역할" 선택
2. 사용자가 피해자처럼 말함
3. AI가 피싱범 역할로 응답 (스캠 점수 계산 안 됨)
4. AI의 응답 패턴 확인

---

## 결론

역할 선택 기능을 통해 사용자는 다양한 시나리오를 테스트할 수 있으며, AI는 선택된 역할에 따라 적절하게 응답합니다. 실제 피싱 전화 분석을 위해서는 "피싱범 역할"을 선택하는 것을 권장합니다.
